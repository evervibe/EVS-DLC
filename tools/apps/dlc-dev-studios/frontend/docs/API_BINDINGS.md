# API Bindings

This document describes the API endpoints that the DLC Web Admin frontend connects to.

## Base URL
The API base URL is configured via the `VITE_API_URL` environment variable.

Default: `http://localhost:4000`

## Endpoints

### Health Check

#### GET /healthz
Check API health status

**Response:**
```json
{
  "status": "ok"
}
```

### Items (t_item)

#### GET /data/t_item
Retrieve all items

**Response:** Array of TItem objects
```typescript
interface TItem {
  id: number;
  code: string;
  name: string | null;
  type: number | null;
  level: number | null;
  created_at: string | null;
}
```

#### GET /data/t_item/:id
Retrieve a single item by ID

**Response:** Single TItem object

#### POST /data/t_item
Create a new item

**Request Body:**
```typescript
{
  code: string;
  name?: string | null;
  type?: number | null;
  level?: number | null;
}
```

**Response:** Created TItem object

#### PUT /data/t_item/:id
Update an existing item

**Request Body:** Partial TItem (any fields to update)

**Response:** Updated TItem object

#### DELETE /data/t_item/:id
Delete an item

**Response:** No content (204)

### Skills (t_skill)

#### GET /data/t_skill
Retrieve all skills

**Response:** Array of TSkill objects
```typescript
interface TSkill {
  id: number;
  code: string;
  name: string | null;
  description: string | null;
  max_level: number | null;
}
```

#### GET /data/t_skill/:id
Retrieve a single skill by ID

#### POST /data/t_skill
Create a new skill

**Request Body:**
```typescript
{
  code: string;
  name?: string | null;
  description?: string | null;
  max_level?: number | null;
}
```

#### PUT /data/t_skill/:id
Update an existing skill

#### DELETE /data/t_skill/:id
Delete a skill

### Skill Levels (t_skilllevel)

#### GET /data/t_skilllevel
Retrieve all skill levels

**Response:** Array of TSkillLevel objects
```typescript
interface TSkillLevel {
  id: number;
  skill_id: number;
  level: number;
  required_exp: number | null;
  effect_value: number | null;
}
```

#### GET /data/t_skilllevel/:id
Retrieve a single skill level by ID

#### POST /data/t_skilllevel
Create a new skill level

**Request Body:**
```typescript
{
  skill_id: number;
  level: number;
  required_exp?: number | null;
  effect_value?: number | null;
}
```

#### PUT /data/t_skilllevel/:id
Update an existing skill level

#### DELETE /data/t_skilllevel/:id
Delete a skill level

### Strings (t_string)

#### GET /data/t_string
Retrieve all localization strings

**Response:** Array of TString objects
```typescript
interface TString {
  id: number;
  key: string;
  value: string | null;
  language: string | null;
}
```

#### GET /data/t_string/:id
Retrieve a single string by ID

#### POST /data/t_string
Create a new string

**Request Body:**
```typescript
{
  key: string;
  value?: string | null;
  language?: string | null;
}
```

#### PUT /data/t_string/:id
Update an existing string

#### DELETE /data/t_string/:id
Delete a string

## Error Handling

All endpoints may return error responses:

**400 Bad Request**
```json
{
  "statusCode": 400,
  "message": "Validation error",
  "error": "Bad Request"
}
```

**401 Unauthorized**
```json
{
  "statusCode": 401,
  "message": "Unauthorized",
  "error": "Unauthorized"
}
```

**404 Not Found**
```json
{
  "statusCode": 404,
  "message": "Resource not found",
  "error": "Not Found"
}
```

**500 Internal Server Error**
```json
{
  "statusCode": 500,
  "message": "Internal server error",
  "error": "Internal Server Error"
}
```

## Authentication

Currently, authentication is a placeholder. In future versions:
- Login will return a JWT token
- Token should be stored in localStorage
- Token will be sent in Authorization header: `Bearer <token>`
- 401 responses will redirect to login page

## Notes

- All `created_at` timestamps are ISO 8601 strings
- Nullable fields may be omitted or set to `null`
- IDs are auto-generated by the database
- Updates are partial - only send fields to change
